## SDN-based Anomaly Detection Project

This project contains these functions:
1: Generate DDOS and benign dataset using Mininet
2: Train a Random Forest model and import in a Ryu-Controller to catch and detect the traffic
3: Implement mitigation base on the attack type:
    Smurf: Completely block sending packet to Broadast address
    Other types: Heavily limit the traffic (byte rate, packet size, ...)

### Prerequisites

* **Operating System**: Ubuntu 18.04/20.04 (recommended)
* **Python**:

  * **Python 3.8+** for training the model and exporting the scaler/model artifacts.
  * **Python 2.7** (default) for all Ryu controller and traffic generation scripts.
* **Mininet**: for network simulation
* **Ryu**: SDN controller framework
* **Traffic Tools**:

  ```bash
  sudo apt-get install hping3
  ```
* **Python libraries** (install under Python 3 environment):

  ```bash
  python3 -m pip install pandas scikit-learn joblib numpy
  ```
* **Ryu Python dependencies** (Python 2 environment):

  ```bash
  pip install ryu
  ```

### Project Structure

```
controller/        # Ryu controller
  ├── ctl_rd.py    # Controller with mitigation (rd -> third)
  ├── ctl_st.py    # Controller with detection (st -> first)
  ├── switch.py
  ├── switchm.py
  ├── train.py
  ├── combined.csv
  ├── rf_model_*.joblib
  └── rf_scaler_*.joblib
traffic/           # Traffic generation (Python 2)
  ├── mein_topo.py
  ├── demo.py
  ├── icmp_bn.py
  ├── icmp_fl.py
  ├── smurf_bn.py
  ├── smurf_fl.py
  ├── tcp_bn.py
  ├── tcp_sync.py
  ├── udp_bn.py
  └── udp_fl.py

```

### 1. Data Preparation & Model Training

1. Place the combined dataset (`combined.csv`) in the `controller/` directory.
2. CD to `controller/` and run these commands:

   ```bash
   python3 train.py
   ```
3. After training, two files will be generated in `controller/`:

   * `rf_model_1.joblib`
   * `rf_scaler_1.joblib`

> **Note**: The training and model export must be done under Python 3. The Ryu controllers will import these `.joblib` files when they start.

### 2. Starting the Ryu Controller

Open a terminal and start the Ryu manager with your chosen controller:

* **Mitigation embedded controller**:

  ```bash
  ryu-manager controller/ctl_rd.py
  ```

* **Detection embedded controller**:

  ```bash
  ryu-manager controller/ctl_st.py
  ```

> **Model Import**: Mitigation controller  will `joblib.load()` the scaler and model files generated by `train.py`.

### 3. Generating Traffic

From the `traffic/` directory, run each script (Python 2) to generate labeled flows:

```bash
python gen_benign.py
python gen_smurf.py
python gen_udp_flood.py
python gen_tcp_sync.py
python gen_icmp.py
```

* Make sure each script is configured with the correct controller IP (from `ifconfig`).
* Scripts will emit traffic and log to CSV with labels: `benign`, `smurf`, `udp flood`, `tcp sync`, `icmp`.
* You can further test the model's performance by runing "sudo python demo.py" which will generate a diversity types of trafic

### 4. Monitoring & Results

* The Ryu controller will classify flows in real time, appending results to `controller/prd.csv`.
* To view live logs:

  ```bash
  tail -f controller/prd.csv
  ```

### 5. Cleaning Up

* To stop traffic generation, interrupt the Python script (Ctrl+C).
* Clear Mininet state before the next run:

  ```bash
  sudo mn -c
  ```
* Exit Mininet CLI with `exit` and stop Ryu with `Ctrl+C`.

---

Just adjust paths, scripts, or topology parameters to match your environment, as well as you testing demand^^
